{% extends 'layout.html' %}
{% block inner %}
  <div class="container">
    <h3>{{ heading }}</h3>
    <div class="jumbotron" id="settings">
        <form class="form-horizontal" method="POST">
          <div class="form-group">
            <h4><label for="classname" class="col-sm-2 control-label">Class Name</label></h4>
            <div class="col-sm-8 col-md-8">
              <input type="text" class="form-control" id="classname" 
              name="classname" placeholder="Class Name" required>
            </div>
          </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Include:</h3>
                </div>
                <div class="panel-body">
                  <div class="form-group container">
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="gender" id="gender"> Student Gender
                        </label>
                      </div>
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="score" id="score"> Student Scores
                        </label>
                      </div>
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="stud_pref" id="stud_pref">Student Preference (students top three choices)
                        </label>
                      </div>
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="lead_pref" id="lead_pref">Proposal Presenter Preference (presenter's teammate preferences)
                        </label>
                      </div>
                  </div>
                </div>
            </div>
          <div class="form-group">
            <div class="col-md-10">
               <a href="#data-entry"><button type="submit" class="btn btn-default">Enter Settings</button></a>
            </div>
          </div>
        </form>
    </div>
    <div class="jumbotron" id="data-entry">
        <form class="form-horizontal" enctype="multipart/form-data">
          <div class="form-group">
            <div class="panel panel-info">
              <!-- Default panel contents -->
              <div class="panel-heading"><h5>Paste Class Data</h5></div>
              <div class="panel-body">
                <p>You can copy/paste into the table from any spreadsheet, or manually type entries. Please note that this product is in beta, and currently doesn't perform any validations. Therefore, it is important to ensure that: 1) GENDER is either M/F, 2) SCORE is a valid number, and 3) PREFERENCES exactly match group names.</p>
              </div>
              <!-- Table -->
              <div id = "students_enter">
              </div>
            </div>
          </div>
          <div class="form-group" id="grp_data">
            <div class="panel panel-info">
              <!-- Default panel contents -->
              <div class="panel-heading"><h5>Paste Group Data</h5></div>
                <div class="panel-body">
                  <p>You can copy/paste into the table from any spreadsheet, or manually type entries. Please note that this product is in beta, and currently doesn't perform any validations. Therefore, it is important to ensure that: 1) GROUP NAMES exactly match the STUDENT PREFERENCES in the class data, 2) PROPOSAL PRESENTERS are included in the class data and exactly match their uniquenames in the class data, and 3) TEAMMATE PREFERENCES exactly match student uniquenames in the class data.</p>
                  <h4 class="col-md-offset-8">Add/Remove Teammate Preference</h4>
                  <div class="col-md-offset-10 btn-group" id="add_sub_pref">
                    <button id="add_pref" type="button" class="btn btn-default"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button>
                    <button id="sub_pref" type="button" class="btn btn-default"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button>
                  </div>
                </div>
                <div id = "groups_enter">
                </div>
            </div>
          </div> 
          <div class="form-group">
            <div class="col-md-10">
              <a href="#class-sort"><button id = "upload" type="button" class="btn btn-default">Upload</button></a>
            </div>
          </div>
        </form>
    </div>
    <div class="jumbotron" id="class-sort">
        <div class="container-fluid">
            <!--Sort Functions Menu-->
            <nav class="navbar navbar-default">
              <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand">Sort Functions</a>
                </div>
                <div class="collapse navbar-collapse" id="sort-fn">
                  <ul class="nav navbar-nav">
                    <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Group Size<span class="caret"></span></a>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#">Sort Females</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li class="divider"></li>
                        <li><a href="#">Separated link</a></li>
                        <li class="divider"></li>
                        <li><a href="#">One more separated link</a></li>
                      </ul>
                    </li>
                    <li class="dropdown" id="class-fn">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Class Functions<span class="caret"></span></a>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#" id="srt_fem">Sort Females</a></li>
                        <li><a href="#" id="sort_frst">Sort by Top Preference</a></li>
                        <li role="presentation" class="divider"></li>
                        <li><a href="#" id="srt_non">Sort Students into Smallest Groups</a></li>
                      </ul>
                    </li>
                    <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li class="divider"></li>
                        <li><a href="#">Separated link</a></li>
                        <li class="divider"></li>
                        <li><a href="#">One more separated link</a></li>
                      </ul>
                    </li>
                  </ul>
                </div><!-- /.navbar-collapse -->
              </div><!-- /.container-fluid -->
            </nav>
            <!--<div class="panel panel-default">
                
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Group Size Settings</h3>
                                </div>
                                <div class="panel-body">
                                    <label for="grp_range">Set Max/Min Group Sizes</label>
                                    <input type="text" id="grp_range" name="grp_range" value=""/>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Group Settings</h3>
                                </div>
                                <table class="table">
                                    <tr>
                                        {% if class_data.score %}<td class="right">
                                        <button type="button" id="ordr_scr" class="btn btn-primary btn-xs icon-btn" >Sort Groups by Score</button></td>
                                        {% endif %}
                                        <th>Add/Remove Students by:</th>
                                        <td class="right">
                                            <label>
                                                 <input type="checkbox" name="2nd" id="2nd" checked>2nd Choice
                                            </label>
                                            <label>
                                                <input type="checkbox" name="3rd" id="3rd">3rd Choice
                                            </label>
                                        </td>
                                        <td><button type="button" id="srt_rand" class="btn btn-primary">Create Randomized Groups</button></td>
                                    </tr>
                                    <tr class="info top">
                                        <th>Lock Presenters</th>
                                        <th>{% if class_data.lead_pref %}Lock Presenter Preferences{% endif %}</th>
                                        <th>{% if class_data.gender %}Lock Females{% endif %}</th>
                                        <th></th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class= "btn-group">
                                                <button type="button" class="btn btn-default btn-xs icon-btn disabled" title="Lock Proposal Presenters"><i class="icon-large icon-user icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="lock_pres"><i class="icon-large icon-lock icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="unlock_pres"><i class="icon-large icon-unlock icon"></i></button>
                                            </div>
                                        </td>
                                        {% if class_data.lead_pref %}<td>
                                            <div class= "btn-group">
                                                <button type="button" class="btn btn-default btn-xs icon-btn disabled" title="Lock Proposal Presenter Preferences"><i class="icon-large icon-group icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="lock_prefs"><i class="icon-large icon-lock icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="unlock_prefs"><i class="icon-large icon-unlock icon"></i></button>
                                            </div>
                                        </td>{% endif %}
                                        {% if class_data.gender %}<td>
                                            <div class= "btn-group">
                                                <button type="button" class="btn btn-default btn-xs icon-btn disabled" title="Lock Females"><i class="icon-large icon-girl icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="lock_fem"><i class="icon-large icon-lock icon"></i></button>
                                                <button type="button" class="btn btn-default btn-xs icon-btn" id="unlock_fem"><i class="icon-large icon-unlock icon"></i></button>
                                            </div>
                                        </td>{% endif %}
                                        <td></td>
                                    </tr>
                                </table>
                            </div>
                        </div>                    
                    </div>
                </div>
            </div>-->
            <!--Class and Group Data-->
            <div class="row-fluid">
                <div class="col-md-3">
                    <label for="sortable_class" class="control-label">Class List</label>
                    <ul id="sortable_class" class="droptrue list-group">
                        {% for student in class_data.classlist %}
                        <li class="ui-state-default list-group-item student" id="{{ student.name }}">
                            {% set count = loop.index %}
                            {{ count }}
                            <button type="button" class="btn btn-default btn-xs lock" id="lock_{{ student.name }}"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span></button> 
                            <label for="{{ student.name }}" id="name_{{ student.name }}">{{ student.name }}</label>
                            {% if class_data.gender %}
                            M/F: 
                            <label for="{{ student.name }}" id="gender_{{ student.name }}">{{ student.gender }}</label>
                            {% endif %}
                            {% if class_data.score %}
                            Score: 
                            <label for="{{ student.name }}" id="score_{{ student.name }}">{{ student.score }}</label>
                            {% endif %}
                            Prefs: 
                            <label for="{{ student.name }}" id="first_{{ student.name }}">{{ student.first }}</label>
                            <label for="{{ student.name }}" id="second_{{ student.name }}">{{ student.second }}</label>
                            <label for="{{ student.name }}" id="third_{{ student.name }}">{{ student.third }}</label> 
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="col-md-9">
                    <div class="row-fluid">
                    <label for="grp_tbl">Groups</label>
                    <table class="table table-bordered" id="grp_tbl">
                    {% set count = 0 %}
                    <tr>
                    {% for group in class_data.grouplist %}
                        {% if count == 3%}
                            </tr>
                            {% set count = 0 %}
                            <tr>
                        {% endif %}
                        <td>
                        <div id= "obj_{{ group.id }}">
                            <label for="{{ group.id }}" id="gid_{{ group.id }}" class="control-label">{{ group.id }}</label>.)
                            <label for="{{ group.id }}" id="gname_{{ group.id }}" class="control-label">{{ group.groupname }}</label> -<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                            <label for="{{ group.id }}" id="glead_{{ group.id }}" class="control-label">{{ group.leader }}</label>
                            <input type ="number" value="0" id="gcount_{{ group.id }}" style="width: 30px; margin: 5px" readonly="true"> 
                            <div id="group_{{ group.id }}"class="btn-group" role="group" aria-label="...">
                              <button type="button" class="btn btn-default add_mem" id="a_{{ group.id }}"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button>
                              <button type="button" class="btn btn-default remove_mem" id="r_{{ group.id }}"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button>
                              <button type="button" class="btn btn-default delete_grp" id="d_{{ group.id }}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                            </div>
                            <input type ="hidden" value="{{ group.preferences }}" id="prefs_{{ group.id }}">
                            <ul id="{{ group.id }}" class="droptrue group_mems"></ul> 
                        </div>
                        </td>
                        {% set count = count + 1 %}
                    {% endfor %}       
                </div>
            </div>
        </div>   
    </div>
  </div>
{% endblock %}
